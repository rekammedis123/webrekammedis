<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<link rel="icon" href="logorekammedis.ico">
<title>Kunjungan Pasien | Medical Record</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
  --green:#2fa36b;
  --green-dark:#1f7f53;
  --bg:#eef5f2;
  --card:#ffffff;
  --shadow:0 12px 30px rgba(0,0,0,.12);
}
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Arial}
html,body{
  min-height:100vh;
  background:var(--bg);
  display:flex;
  flex-direction:column;
}

/* ===== HEADER ===== */
header{
  background:linear-gradient(135deg,#ffffff,#e9f7f0);
  padding:15px 20px;
  box-shadow:var(--shadow);
}
.logo img{width:300px;height:70px}

/* ADMIN */
.admin-btn{
  margin-left:auto;
  background:linear-gradient(135deg,var(--green),var(--green-dark));
  color:#fff;
  padding:8px 18px;
  border-radius:30px;
  font-size:12px;
  text-decoration:none;
  display:flex;
  align-items:center;
  gap:8px;
  box-shadow:var(--shadow);
  transition:.3s;
}
.admin-btn:hover{transform:translateY(-2px)}
.header-bar{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:15px;
  flex-wrap:wrap;
}

/* ===== NAV ===== */
nav ul{
  list-style:none;
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  gap:6px;
  padding:10px;
  margin-top:15px;
  background:#fff;
  border-radius:50px;
  box-shadow:var(--shadow);
}
nav ul li a{
  text-decoration:none;
  color:#444;
  font-weight:600;
  font-size:14px;
  border-radius:50px;
  padding:6px 16px;
  display:flex;
  align-items:center;
  gap:6px;
  transition:.3s;
}
nav ul li a:hover{
  background:linear-gradient(135deg,var(--green),var(--green-dark));
  color:#fff;
}

/* ===== MAIN ===== */
main{flex:1;padding:30px 20px}

/* PANEL */
.content{
  max-width:1300px;
  margin:auto;
  background:var(--card);
  padding:30px;
  border-radius:22px;
  box-shadow:var(--shadow);
  opacity:0;
  transform:translateY(30px);
  transition:.6s ease;
}
.content.show{opacity:1;transform:none}

/* ===== LAYOUT ===== */
.layout{
  display:grid;
  grid-template-columns:1fr 320px;
  gap:25px;
}

/* ===== SIDEBAR ===== */
.sidebar{
  background:linear-gradient(180deg,#ffffff,#f0fdf4);
  border-radius:20px;
  padding:22px;
  box-shadow:var(--shadow);
  height:fit-content;
}
.sidebar h3{
  color:var(--green);
  margin-bottom:15px;
  display:flex;
  gap:8px;
}
.sidebar ul{list-style:none}
.sidebar ul li a{
  display:flex;
  align-items:center;
  gap:10px;
  padding:12px 16px;
  margin-bottom:10px;
  border-radius:14px;
  text-decoration:none;
  font-weight:600;
  color:#333;
  background:#fff;
  box-shadow:0 6px 16px rgba(0,0,0,.08);
  transition:.3s;
}
.sidebar ul li a:hover{
  background:linear-gradient(135deg,var(--green),var(--green-dark));
  color:#fff;
  transform:translateX(5px);
}

/* ===== TITLE ===== */
h2{
  font-size:28px;
  color:var(--green);
  margin-bottom:25px;
  display:flex;
  gap:10px;
}

/* ===== CARD ===== */
.card{
  background:var(--card);
  padding:22px;
  border-radius:20px;
  margin-bottom:25px;
  box-shadow:var(--shadow);
  
  opacity:0;
  transform:translateY(25px);
  transition:.6s;
}
.card.show{opacity:1;transform:none}

/* SELECT */
.select-wrapper{
  display:flex;
  align-items:center;
  gap:14px;
}
select{
  padding:8px 16px;
  border-radius:12px;
  border:1px solid #ccc;
  font-weight:600;
}

/* STYLE DROPDOWN HUBUNGI KAMI */
    .dropdown-hubungi {
      position: relative;
      display: inline-block;
    }
    
    .dropdown-content-hubungi {
      display: none;
      position: absolute;
      background-color: #f9f9f9;
      min-width: 160px;
      box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
      z-index: 1;
      border-radius: 10px;
      overflow: hidden;
    }
    
    .dropdown-content-hubungi a {
      color: #333;
      padding: 10px 15px;
      font-size:14px;
      text-decoration: none;
      display: block;
      font-weight: 600;
      transition: all 0.3s;
    }
    .dropdown-content-hubungi a:hover {
      background-color: #e2f8f1;
      color: #1f8664;
    }
    
    .dropdown-hubungi:hover .dropdown-content-hubungi {
      display: block;
    }

/* TABLE */
table{
  width:100%;
  border-collapse:separate;
  border-spacing:0;
  border-radius:14px;
  overflow:hidden;
}
th{
  background:linear-gradient(135deg,var(--green),var(--green-dark));
  color:#fff;
  padding:10px;
}
td{
  padding:10px;
  text-align:center;
}
tr:nth-child(even){background:#f0fdf4}

/* FOOTER */
footer{
  background:#fff;
  padding:30px 20px;
  box-shadow:var(--shadow);
}
.small{font-size:14px;color:#666}

/* LOADING */
.loading{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.25);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:9999;
  opacity:0;
  pointer-events:none;
  transition:.3s;
}
.loading.show{opacity:1;pointer-events:auto}
.spinner{
  width:36px;height:36px;
  border:4px solid #ececec;
  border-top:4px solid var(--green);
  border-radius:50%;
  animation:spin 1s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}

@keyframes fadeUp{
  from{opacity:0;transform:translateY(20px)}
  to{opacity:1}
}

@media(max-width:900px){
  .hero-grid{grid-template-columns:1fr}
}
@media(max-width:1024px){
  .layout{
    grid-template-columns:1fr;
  }

  .sidebar{
    order:2;
  }
}
</style>
</head>

<body>

<header>
  <div class="header-bar">
    <div class="logo">
      <img src="logopanjang.png">
    </div>

    <a href="admin_index.html" class="admin-btn">
      <i class="fas fa-user-shield"></i> Admin Dashboard
    </a>
  </div>

  <nav>
    <ul>
      <li><a href="index.html"><i class="fas fa-home"></i> BERANDA</a></li>
      <li><a href="profil.html"><i class="fas fa-user-circle"></i> PROFIL</a></li>
      <li><a href="regulasi.html"><i class="fas fa-swatchbook"></i> REGULASI</a></li>
      <li><a href="informasi.html"><i class="fas fa-info-circle"></i> INFORMASI</a></li>
      <li><a href="layanan.html"><i class="fas fa-headset"></i> LAYANAN INTERNAL</a></li>
      <li><a href="indikator.html"><i class="fas fa-chart-line"></i> INDIKATOR</a></li>
      <li><a href="laporan.html"><i class="fas fa-database"></i> LAPORAN</a></li>
      <li><a href="kegiatan.html"><i class="fas fa-calendar-check"></i> KEGIATAN</a></li>
      <li class="dropdown-hubungi">
          <a class="dropbtn-hubungi"><i class="fas fa-phone"></i> HUBUNGI KAMI <i class="fas fa-caret-down"></i></a>
          <div class="dropdown-content-hubungi">
            <a href="#"><i class="fas fa-envelope"></i> Email</a>
            <a href="#"><i class="fas fa-phone"></i> Telepon</a>
            <a href="https://wa.me/6283153300859"><i class="fab fa-whatsapp"></i> WhatsApp</a>
            <a href="#"><i class="fas fa-map-marker-alt"></i> Alamat</a>
          </div>
        </li>
    </ul>
  </nav>
</header>

<div class="loading" id="loading"><div class="spinner"></div></div>

<main>
<div class="content">

<h2>ðŸ“Š Kunjungan Pasien</h2>

<div class="layout">

<div>
  <div class="card">
    <div class="select-wrapper">
      <strong>ðŸ“… Tahun</strong>
      <select id="tahun"></select>
    </div>
  </div>

  <div class="card">
    <h3 id="judulTabel"></h3>
    <table>
      <thead>
        <tr>
          <th>Bulan</th>
          <th>Rawat Jalan</th>
          <th>Rawat Inap</th>
          <th>IGD</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody id="tabelData"></tbody>
    </table>
  </div>

  <div class="card">
    <h3 id="judulGrafik"></h3>
    <div style="height:420px">
      <canvas id="chartCanvas"></canvas>
    </div>
  </div>
</div>

<aside class="sidebar">
  <h3><i class="fas fa-list"></i> Daftar Indikator</h3>
  <ul>
    <li><a href="imut.html"><i class="fas fa-chart-line"></i> Indikator Mutu</a></li>
    <li><a href="indikatorbor.html"><i class="fas fa-bed"></i> Indikator BOR LOS TOI</a></li>
    <li><a href="kunjungan_pasien.html"><i class="fas fa-users"></i> Indikator Kunjungan Pasien</a></li>
  </ul>
</aside>

</div>
</div>
</main>

<footer>
<strong>MEDICAL RECORD</strong>
<div class="small">Â© 2025 RSU An'Nimah â€¢ Unit Rekam Medis</div>
</footer>

<script>
const loading=document.getElementById("loading");
const cards=document.querySelectorAll(".card");
const tahun=document.getElementById("tahun");
const tabelData=document.getElementById("tabelData");
const chartEl=document.getElementById("chartCanvas");

const API_URL="https://script.google.com/macros/s/AKfycbz833hLYkNk5v4_Bi1OD-XZBWcpG5k9jUKRh1Zti9gpB31b3QPgN0Y3cTKn5FL-6WSV/exec";
const bulan=["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"];
let chart;

function showLoader(v){loading.classList.toggle("show",v);}
function showCards(){cards.forEach((c,i)=>setTimeout(()=>c.classList.add("show"),i*120));}

(function(){
  const now=new Date().getFullYear();
  for(let y=2020;y<=now;y++){
    const o=document.createElement("option");
    o.value=y;o.textContent=y;
    if(y===now)o.selected=true;
    tahun.appendChild(o);
  }
})();

function loadData(){
  showLoader(true);
  fetch(API_URL+"?tahun="+tahun.value)
  .then(r=>r.json())
  .then(d=>{
    let html="", rj=[], ri=[], igd=[], total=[];
    bulan.forEach(b=>{
      const x=d.find(i=>i.bulan===b)||{};
      html+=`<tr>
        <td>${b}</td>
        <td>${x.rj||0}</td>
        <td>${x.ri||0}</td>
        <td>${x.igd||0}</td>
        <td><b>${x.total||0}</b></td>
      </tr>`;
      rj.push(x.rj||0); ri.push(x.ri||0); igd.push(x.igd||0); total.push(x.total||0);
    });
    tabelData.innerHTML=html;
    if(chart) chart.destroy();
    chart=new Chart(chartEl,{
      data:{labels:bulan,datasets:[
        {type:"bar",label:"Rawat Jalan",data:rj,backgroundColor:"rgba(47,163,107,.6)"},
        {type:"bar",label:"Rawat Inap",data:ri,backgroundColor:"rgba(59,130,246,.6)"},
        {type:"bar",label:"IGD",data:igd,backgroundColor:"rgba(239,68,68,.6)"},
        {type:"line",label:"Total",data:total,borderColor:"#ca8a04",tension:.3}
      ]},
      options:{responsive:true,maintainAspectRatio:false}
    });
    judulTabel.innerText="ðŸ“‹ Rekap Tahun "+tahun.value;
    judulGrafik.innerText="ðŸ“ˆ Grafik Tahun "+tahun.value;
    showLoader(false);
    document.querySelector(".content").classList.add("show");
    showCards();
  });
}
tahun.onchange=loadData;
loadData();
</script>

</body>
</html>
