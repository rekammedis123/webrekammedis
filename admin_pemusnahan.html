<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Admin Pemusnahan DRM</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{font-family:Arial;background:#f0fdf4;margin:0}
.container{max-width:900px;margin:40px auto;background:#fff;padding:30px;border-radius:14px}
input,textarea{width:100%;padding:10px;margin:6px 0 14px}
button{background:#16a34a;color:#fff;border:none;padding:12px 20px;border-radius:10px;cursor:pointer}
.item{border-bottom:1px solid #ddd;padding:10px 0}
</style>
</head>

<body>
<div class="container">
<h2>Admin Pemusnahan DRM</h2>

<label>Judul</label>
<input id="judul">

<label>Tanggal</label>
<input type="date" id="tanggal">

<label>Lokasi</label>
<input id="lokasi">

<label>Narasi</label>
<textarea id="isi"></textarea>

<label>Foto</label>
<input type="file" id="foto" accept="image/*">

<button onclick="simpan()">Simpan</button>
<p id="status"></p>

<hr>
<h3>Data Tersimpan</h3>
<div id="list"></div>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycby-ZQ3obQ7jkIsEi2tu-HQyINZmlcP04sElMDG-VuMvZnAThwgeU2gLrsj9gCmYsP4T/exec";
const list = document.getElementById("list");

function load(){
 fetch(API_URL,{
  method:"POST",
  body:JSON.stringify({action:"get"})
 })
 .then(r=>r.json())
 .then(d=>{
   list.innerHTML="";
   d.forEach(x=>{
     list.innerHTML+=`
      <div class="item">
        <b>${x.judul}</b><br>
        ${x.tanggal} - ${x.lokasi}<br>
        <img src="${x.foto}" width="120"><br>
        <button onclick="hapus('${x.id}')">Hapus</button>
      </div>`;
   });
 });
}

function simpan(){
 const file = foto.files[0];
 if(!file){alert("Foto wajib");return;}

 const reader = new FileReader();
 reader.onload = ()=>{
  fetch(API_URL,{
   method:"POST",
   body:JSON.stringify({
     action:"save",
     judul:judul.value,
     tanggal:tanggal.value,
     lokasi:lokasi.value,
     isi:isi.value,
     foto:reader.result
   })
  })
  .then(r=>r.json())
  .then(()=>{
    status.innerText="âœ… Tersimpan";
    judul.value=lokasi.value=isi.value="";
    foto.value="";
    load();
  });
 };
 reader.readAsDataURL(file);
}

function hapus(id){
 fetch(API_URL,{
  method:"POST",
  body:JSON.stringify({action:"hapus",id})
 }).then(load);
}

load();
</script>
</body>
</html>
